<script>
/* ================= LOGIN PROTECTION ================= */
const user = localStorage.getItem("mj_user");
if (!user) {
    window.location.replace("index.html");
}

/* ================= DAILY MOTIVATION ================= */
const tips = [
    "Consistency beats perfection. Speak one new sentence today! ðŸ’¬",
    "Mistakes are proof that you're trying. Keep going! ðŸ”¥",
    "Every day you practice, you get closer to fluency.",
    "You don't need to be perfect â€” just start speaking!",
    "The best way to learn English is to use it daily.",
    "Your future self will thank you for starting today.",
    "Small progress every day leads to big results!",
    "Fear less, speak more. You've got this! ðŸš€"
];
document.getElementById("dailyTip").innerText =
    tips[new Date().getDate() % tips.length];

/* ================= FOUNDER TOGGLE ================= */
function toggleFounder() {
    const info = document.getElementById("founderInfo");
    const btn = document.querySelector(".reveal-btn");
    if (info.style.display === "block") {
        info.style.display = "none";
        btn.innerText = "ðŸ”“ Reveal Founder";
    } else {
        info.style.display = "block";
        btn.innerText = "ðŸ™ˆ Hide Founder";
    }
}

/* ================= DAYS & PROGRESS ================= */
const dayGrid = document.getElementById("dayGrid");

for (let i = 1; i <= 30; i++) {
    const day = document.createElement("div");
    day.className = "day";
    day.innerHTML = `<p>Day ${i}</p><a href="days/day${i}.html">Start â†’</a>`;

    if (localStorage.getItem(`day${i}-completed`)) {
        day.classList.add("completed");
        day.querySelector("a").innerText = "âœ… Completed";
    }

    day.onclick = () => {
        localStorage.setItem(`day${i}-completed`, "true");
        day.classList.add("completed");
        day.querySelector("a").innerText = "âœ… Completed";
        updateProgress();
    };

    dayGrid.appendChild(day);
}

function updateProgress() {
    let completed = 0;
    for (let i = 1; i <= 30; i++) {
        if (localStorage.getItem(`day${i}-completed`)) completed++;
    }

    document.getElementById("progressText").innerText =
        `Completed: ${completed}/30 days`;

    document.getElementById("progressBar").style.width =
        (completed / 30) * 100 + "%";

    document.getElementById("streakText").innerText =
        completed > 0 ? "Keep the streak going! ðŸ”¥" : "Start your streak today! ðŸ”¥";

    if (completed === 30) {
        document.getElementById("congratsMessage").style.display = "block";
    }
}
updateProgress();

/* ================= VISITOR POPUP ================= */
const WHATSAPP_NUMBER = "919552181517";

setTimeout(() => {
    if (!localStorage.getItem("mjcrpgVisitor")) {
        document.getElementById("visitorPopup").style.display = "flex";
    }
}, 7000);

function closePopup() {
    document.getElementById("visitorPopup").style.display = "none";
}

function submitVisitor() {
    const name = document.getElementById("visitorName").value.trim();
    if (!name) {
        alert("Please enter your name ðŸ˜Š");
        return;
    }

    localStorage.setItem("mjcrpgVisitor", "true");

    const message =
        `Hello MJCRPG ðŸ‘‹%0AName: ${encodeURIComponent(name)}%0AInterested in 30-Day Spoken English Course`;

    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${message}`, "_blank");
    closePopup();
}
</script>
